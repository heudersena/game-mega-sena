"use strict";var re=Object.create;var nt=Object.defineProperty,se=Object.defineProperties,ae=Object.getOwnPropertyDescriptor,oe=Object.getOwnPropertyDescriptors,ne=Object.getOwnPropertyNames,St=Object.getOwnPropertySymbols,ie=Object.getPrototypeOf,ft=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var Et=(a,t,e)=>t in a?nt(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,gt=(a,t)=>{for(var e in t||(t={}))ft.call(t,e)&&Et(a,e,t[e]);if(St)for(var e of St(t))ce.call(t,e)&&Et(a,e,t[e]);return a},At=(a,t)=>se(a,oe(t)),c=(a,t)=>nt(a,"name",{value:t,configurable:!0});var me=(a,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of ne(t))!ft.call(a,r)&&r!==e&&nt(a,r,{get:()=>t[r],enumerable:!(s=ae(t,r))||s.enumerable});return a};var N=(a,t,e)=>(e=a!=null?re(ie(a)):{},me(t||!a||!a.__esModule?nt(e,"default",{value:a,enumerable:!0}):e,a));var wt=(a,t,e)=>{if(!t.has(a))throw TypeError("Cannot "+e)};var L=(a,t,e)=>(wt(a,t,"read from private field"),e?e.call(a):t.get(a)),it=(a,t,e)=>{if(t.has(a))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(a):t.set(a,e)},ct=(a,t,e,s)=>(wt(a,t,"write to private field"),s?s.call(a,e):t.set(a,e),e);var n=(a,t,e)=>new Promise((s,r)=>{var o=d=>{try{m(e.next(d))}catch(u){r(u)}},l=d=>{try{m(e.throw(d))}catch(u){r(u)}},m=d=>d.done?s(d.value):Promise.resolve(d.value).then(o,l);m((e=e.apply(a,t)).next())});var as=require("dotenv/config"),ut=N(require("express")),Wt=N(require("http")),Qt=N(require("cors")),Zt=N(require("path")),te=require("socket.io");var kt=require("express");var lt=N(require("moment"));var Nt=require("@prisma/client"),i=new Nt.PrismaClient;i.$disconnect();function yt(){let a=[];for(let s=1;s<=60;s++)a.push(s);for(let s=a.length-1;s>0;s--){let r=Math.floor(Math.random()*(s+1));[a[s],a[r]]=[a[r],a[s]]}return a.slice(0,35).sort((s,r)=>s-r)}c(yt,"generateUniqueNumbers12");var y="OPERA\xC7\xC3O EXECUTADA COM SUCESSO.".trim(),O="OPS! OCORREU ALGUM ERRO NO SISTEMA.".trim(),C=c(a=>a.toUpperCase().trim(),"MESSAGE_CUSTOM");var v,mt=(v=class{static create(t,e){return n(this,null,function*(){try{let s=yield i.game.findFirst({orderBy:{created_at:"desc"}}),r=s!=null&&s.match_id?(s==null?void 0:s.match_id)+1:1,o=yield i.bet.findFirst({orderBy:{created_at:"desc"}}),l=o!=null&&o.namber_bet?(o==null?void 0:o.namber_bet)+1:1,m=String(t||yt()),d=yield this._FN_LOCAL_CREATE_BET(r,m,e,l);return{status:!1,message:y,data:d}}catch(s){return{status:!0,message:s,data:[]}}})}static searchForTheLastGame(){return n(this,null,function*(){var o,l;let t=yield i.$queryRaw`CALL PROCEDURE_GAMES('um')`;console.log("VIEW_BUSCAR_ULTIMO_REGISTRO_TABLE_GAMES: ",t);let e=(l=(o=t[0])==null?void 0:o.created_at)!=null?l:new Date,s=(0,lt.default)(e).format("HH:mm:ss"),r=(0,lt.default)(e).add(2,"minutes").format("HH:mm:ss");return{hora_database:s,horaAtualida:r}})}static _FN_LOCAL_CREATE_BET(t,e,s,r){return n(this,null,function*(){try{return yield i.bet.create({data:{number_game_result:String(t),numbers:String(e),establishmentId:s},include:{establishment:{select:{name:!0}}}})}catch(o){return o}})}},c(v,"JogosDatabase"),v);var B,Ot=(B=class{static create(t,e){return n(this,null,function*(){var s;try{let{numbers:r,quantidade:o}=t.body,l=t.user.Establishment[0].id,m=parseInt(o!=null?o:1),d=[];for(let u=0;u<m;u++){let _=yield mt.create(r,l);d.push(_)}e.json({content:d})}catch(r){e.json(((s=r==null?void 0:r.meta)==null?void 0:s.target)=="bets_namber_bet_key"?"Tente novamente!":r)}})}},c(B,"BetController"),B);var M,Ct=(M=class{static winners(t,e){return n(this,null,function*(){return yield i.bet.update({where:{id:e},data:{awarded:!0,status:"FINISHED",hits:t},include:{establishment:!0}})})}static losers(t){return n(this,null,function*(){return yield i.bet.update({where:{id:t},data:{status:"FINISHED"}})})}},c(M,"UpdateValuesTableBet"),M);var U,dt=(U=class{static maior(t,e){return n(this,null,function*(){let s=String(t.query.n),r=yield i.bet.findMany({where:{number_game_result:{equals:s},AND:{awarded:{equals:!0}}},take:8,orderBy:{hits_round:"desc"},include:{establishment:{select:{name:!0}}}});e.json({quantity:r.length,comments:r})})}static check(t,e){return n(this,null,function*(){let s=[],r=t.params.numbers.split(",").map(m=>Number(m)),o=yield i.bet.findMany();if(o.length<=0)return e.json({resultados:s,ganhadores:[]});let l=0;o.forEach((m,d)=>n(this,null,function*(){for(let u of m.numbers.split(",").map(_=>Number(_)))r.includes(u)&&l++;l>=4?(console.log(m.numbers,l),Ct.winners(l,m.id).then(u=>{s.push({id:m.id,numeros:m.numbers,correspondencias:l,aposta:u})})):yield i.bet.update({where:{id:m.id},data:{status:"FINISHED"}})})),e.json({})})}static bkp(t,e){return n(this,null,function*(){let s=[],r=[1,4,4,48,24,60],o=yield i.bet.findMany(),l=yield i.bet.count(),m=0;for(let d=0;d<o.length;d++){let u=o[d].numbers.split(","),_=!0;for(let b=0;b<6;b++)if(console.log(o[d][b]),Number(u[b])!==r[b]){_=!1;break}else console.log(u)}e.json("ok")})}},c(U,"CheckBetController"),U);var Lt=require("uuid"),vt=require("bcrypt");var pt=N(require("bcrypt"));var F,_t=(F=class{static CreatedHash(t){return n(this,null,function*(){let e=pt.default.genSaltSync(10);return pt.default.hashSync(t,e)})}},c(F,"PasswordHash"),F);var Bt=N(require("jsonwebtoken"));var Me=require("dotenv/config"),Tt=N(require("nodemailer"));var ue=Tt.default.createTransport({service:"gmail",port:587,auth:{user:"programadorwebti@gmail.com",pass:process.env.EMAIL_KEY},tls:{rejectUnauthorized:!0,minVersion:"TLSv1.2"}}),I,G,H,x,Rt=(x=class{constructor({to:t,title:e,body:s}){it(this,I,void 0);it(this,G,void 0);it(this,H,void 0);ct(this,I,t),ct(this,G,e),ct(this,H,s)}send(){return n(this,null,function*(){let t={from:L(this,I),to:L(this,I),bcc:"heuder.sicoob@gmail.com",subject:L(this,G),html:L(this,H)};ue.sendMail(t,function(e,s){return e||s})})}},I=new WeakMap,G=new WeakMap,H=new WeakMap,c(x,"CLASSSendEmail"),x);var It=require("crypto");var P,Dt=(P=class{static code(){return n(this,null,function*(){return this._FN_LOCAL_REGENERATED()})}static _FN_LOCAL_REGENERATED(){return n(this,null,function*(){return(0,It.randomUUID)().split("-")[0].substring(0,4).toUpperCase()})}},c(P,"CodeUnique"),P);var j,k=(j=class{static register(t,e,s){return n(this,null,function*(){try{if(yield this._FN_LOCAL_CHECK_IF_THIS_EMAIL_EXISTS(t))return{status:!1,message:C("ESSE EMAIL J\xC1 EXISTE NA BASE DE DADOS."),data:[]};{let r=yield _t.CreatedHash(e),o=s=="SELLER"?yield Dt.code():"",l=yield i.user.create({data:{email:t,password:r,access_role:s,code_ref_user:String(o)}});return l?{status:!1,message:y,data:l}:{status:!0,message:O,data:l}}}catch(r){return{status:!0,message:r,data:[]}}})}static login(t,e){return n(this,null,function*(){let s=process.env.JWT_STRING,r=yield i.user.findFirst({where:{email:t},include:{Establishment:{select:{id:!0}}}});if((0,vt.compareSync)(e,String(r==null?void 0:r.password))){r==null||delete r.password,r==null||delete r.recover_password,r==null||delete r.is_active,r==null||delete r.created_at,r==null||delete r.updated_at;let l=Bt.default.sign({user:JSON.stringify(r)},String(s),{expiresIn:"60m"});return{status:!1,message:y,data:{token:l,user:r}}}return{status:!0,message:C("E-MAIL OU SENHA INV\xC1LIDOS."),data:[]}})}static recovery_password(t){return n(this,null,function*(){if(!(yield this._FN_LOCAL_CHECK_IF_THIS_EMAIL_EXISTS(t)))return{status:!0,message:C("E-MAIL INEXISTENTE NA BASE DE DADOS"),data:[]};let s=(0,Lt.v4)(),r=yield i.user.update({where:{email:t},data:{recover_password:s}});yield new Rt({to:t,title:`RECUPERA SUA SENHA ${new Date().toTimeString()}`,body:`http://192.168.0.111:4008/v1/recover-password/${s}`}).send().then(o=>({status:!1,message:y,data:o})).catch(o=>(console.log(o),{status:!0,message:C("ERROR AO ENVIAR O E-MAIL"),data:[]}))})}static update_password(t,e){return n(this,null,function*(){let s=yield i.user.findFirst({where:{recover_password:t}});if(!s)return{status:!0,message:C("O C\xD3DIGO N\xC3O EXISTE OU EST\xC1 EXPIRADAO."),data:[]};let r=yield _t.CreatedHash(e),o=yield i.user.update({where:{id:s==null?void 0:s.id},data:{password:r,recover_password:""}});return o==null||delete o.password,{status:!1,message:C("SENHA ATUALIZADA COM SUCESSO."),data:o}})}static _FN_LOCAL_CHECK_IF_THIS_EMAIL_EXISTS(t){return n(this,null,function*(){return!!(yield i.user.findUnique({where:{email:t}}))})}},c(j,"UsuariosDatabase"),j);var V,q=(V=class{static CreateNewUser(t,e){return n(this,null,function*(){let{email:s,password:r,access_role:o}=t.body,l=yield k.register(s,r,o);return e.json(l)})}static Login(t,e){return n(this,null,function*(){let{email:s,password:r}=t.body,o=yield k.login(s,r);return e.json(o)})}static recover_password(t,e){return n(this,null,function*(){let{email:s}=t.body,r=yield k.recovery_password(s);return e.json(r)})}static update_recover_password(t,e){return n(this,null,function*(){let{uuid:s}=t.params,{new_password:r}=t.body,o=yield k.update_password(s,r);return e.json(o)})}},c(V,"UsersController"),V);var Mt=require("jsonwebtoken");var J=c((a,t,e)=>n(void 0,null,function*(){let s=a.headers.authorization;if(!s)return t.status(401).json({err:!0,jwt:!0,message:O});let[,r]=s.split(" ");try{let o=(0,Mt.verify)(r,String(process.env.JWT_STRING));return console.log(JSON.parse(o.user)),a.user=JSON.parse(o.user),e()}catch(o){return t.status(401).json({err:!0,jwt:!0,message:O+"CATCH"})}}),"Auth");var X,Ut=(X=class{static create(t,e,s,r,o,l){return n(this,null,function*(){console.log(t);try{let m=yield i.establishment.create({data:{userId:t,name:e,number_phone:s,number_code:r,seller_code:o,description:l}});return{status:!0,message:y,data:m}}catch(m){return{status:!0,message:m,data:[]}}})}},c(X,"EstabalecimentosDatabase"),X);var $,Ft=($=class{static create(t,e){return n(this,null,function*(){console.log("ops");let s=t.user.code_ref_user,{name:r,userId:o,number_phone:l,number_code:m,description:d}=t.body,u=yield Ut.create(o,r,l,m,s,d);e.json(u)})}},c($,"EstablishmentController"),$);var z,Gt=(z=class{static create(t,e,s,r,o,l,m,d,u,_){return n(this,null,function*(){try{let b=yield i.address.create({data:{cep:t,state:e,city:s,neighborhood:r,street:o,number:l,geographic_location:m,latitude:d,longitude:u,establishmentId:_}});return{status:!1,message:y,data:b}}catch(b){return console.log(b),{status:!0,message:O,data:[]}}})}},c(z,"EnderecosDatabase"),z);var Y,Ht=(Y=class{static create(t,e){return n(this,null,function*(){let{cep:s,state:r,city:o,neighborhood:l,street:m,number:d,geographic_location:u,latitude:_,longitude:b}=t.body,{establishmentId:T}=t.params,f=yield Gt.create(s,r,o,l,m,d,u,_,b,Number(T));e.json(f)})}},c(Y,"AdressesController"),Y);var K,xt=(K=class{static init(t,e){return n(this,null,function*(){var w,ot,R;let s=t.params.id,r=yield i.bet.findMany({where:{number_game_result:String(s),AND:{hits_round:{gte:4},AND:{awarded:!0}}}}),o=r.map(g=>g.hits);for(var l={},m=0;m<o.length;m++){var d=o[m];l[d]?l[d]++:l[d]=1}let u=yield i.award.findFirst({where:{gamer_ref:Number(s)}}),_=Number(u==null?void 0:u.subtract_premiums),b=(w=l[4])!=null?w:0,T=(ot=l[5])!=null?ot:0,f=(R=l[6])!=null?R:0;console.log("QUATRO: ",b),console.log("CINCO: ",T),console.log("SEIS: ",f),console.log("ANTES: ",_);let h=0,A=0,p=0;b!=0&&(h=Number(u==null?void 0:u.block)/b,_=Number(_)-Number(u==null?void 0:u.block)),console.log("MEIO1: ",_),T!=0&&(A=Number(u==null?void 0:u.corner)/b,_=Number(_)-Number(u==null?void 0:u.corner)),f!=0&&(p=Number(u==null?void 0:u.seine)/b,_=Number(_)-Number(u==null?void 0:u.seine)),console.log("divisaoFour: ",h.toFixed(2)),console.log("divisaoFive: ",A.toFixed(2)),console.log("divisaoSix: ",p.toFixed(2)),console.log("DEPOIS: ",_.toFixed(2));let S=_>0?_:50;console.log(S.toFixed(2)),e.json({totalValues:_,award:u,quantidade:o,betContent:r})})}},c(K,"ExemploController"),K);var W,Pt=(W=class{static depositar(t){return n(this,null,function*(){let e=yield i.award.findFirst({where:{is_completed:"IN_PROCESSING"},orderBy:{gamer_ref:"desc"},take:1}),s=e==null?void 0:e.id,r=Number(e==null?void 0:e.subtract_premiums)+Number(t),o=yield i.award.update({where:{id:s},data:{subtract_premiums:r,seine:Number(r)*75/100,corner:Number(r)*15/100,block:Number(r)*10/100,home_deposit:Number(t)}});return console.log(o),o})}},c(W,"DepositarDinheiroManualAdminServices"),W);var Q,jt=(Q=class{static create(t,e){return n(this,null,function*(){var s;try{let{amount:r}=(s=t.body)!=null?s:50,o=yield Pt.depositar(Number(r));return t.io.emit("/BUSCAR_VALORES_APOSTA",{subtract_premiums:o==null?void 0:o.subtract_premiums,seine:o==null?void 0:o.seine,corner:o==null?void 0:o.corner,block:o==null?void 0:o.block}),e.json(o)}catch(r){return e.json(r)}})}},c(Q,"DepositarDinheiroManualAdminController"),Q);var E=(0,kt.Router)();E.get("/v1/check/:numbers",dt.check);E.get("/maior",dt.maior);E.post("/v1/bet",J,Ot.create);E.post("/v1/users/register",q.CreateNewUser);E.post("/v1/users/login",q.Login);E.post("/v1/recover-password",q.recover_password);E.post("/v1/recover-password/:uuid",q.update_recover_password);E.post("/v1/establishment",J,Ft.create);E.post("/v1/adresses/:establishmentId",Ht.create);E.post("/v1/auth/verify",J,(a,t)=>{console.log(a.user),t.send(a.user)});E.post("/v1/app-diversity/establishment",J,(a,t)=>{t.send({user:a.user})});E.get("/exemplo/:id",xt.init);E.post("/v1/adiciona-dinheiro",jt.create);var $t=N(require("node-cron")),bt=N(require("moment"));function Vt(){return n(this,null,function*(){let a=yield i.game.findFirst({orderBy:{created_at:"desc"}}),t=1;return(a==null?void 0:a.match_id)==null||(t=(a==null?void 0:a.match_id)+1),t})}c(Vt,"returnLastIdTableGames");function qt(){let a=[];for(let s=1;s<=60;s++)a.push(s);for(let s=a.length-1;s>0;s--){let r=Math.floor(Math.random()*(s+1));[a[s],a[r]]=[a[r],a[s]]}return a.slice(0,6).sort((s,r)=>s-r)}c(qt,"generateUniqueNumbers");function Jt(a,t){return n(this,null,function*(){let e=yield i.award.findFirst({where:{gamer_ref:t}});return e!=null&&e.id?yield i.game.create({data:{numbers:a,match_id:t}}):yield i.game.findFirst({where:{match_id:t-1}})})}c(Jt,"insertValueTableGame");var Z,Xt=(Z=class{static _HANDLE(t,e){return n(this,null,function*(){return yield t.map(r=>n(this,null,function*(){let l=r.numbers.split(",").map(m=>parseInt(m)).filter(m=>e==m);if(l.length!=0){let m=yield i.bet.findUnique({where:{id:r.id}}),d=m!=null&&m.hits_round?(m==null?void 0:m.hits_round)+1:1,u=m!=null&&m.namber_round?(m==null?void 0:m.namber_round)+","+l.toString():l.toString();yield i.bet.update({where:{id:r.id},data:{hits_round:d,namber_round:u}})}return r}))})}},c(Z,"updateEveryRoundOfTheResult"),Z);var tt,et=(tt=class{static buscarValoresDosPremios(){return n(this,null,function*(){return yield i.award.findFirst({select:{subtract_premiums:!0,seine:!0,corner:!0,block:!0},orderBy:{created_at:"desc"},take:1})})}},c(tt,"BuscarUltimoValorPremio"),tt);console.log("CRONJOBGAMER::INICIADO");var rt,zt=(rt=class{static startGamer(t){return n(this,null,function*(){return $t.default.schedule("*/3 * * * *",()=>n(this,null,function*(){console.log("minut"),t.emit("__CLEAN__");let e=String(yield this.FN_GET_NUMBER_GAME()),s=Number(yield this.FN_VERIFY_LAST_INSERT_TABLE_GAMER()),r=yield Jt(e,s),o=String(r==null?void 0:r.match_id);yield i.award.update({where:{id:Number(o)},data:{is_completed:"REFUSES_VALUES"}}).then(f=>{console.log("UPDATE: ",f)});let l=r==null?void 0:r.created_at,m=(0,bt.default)(l).format("HH:mm:ss"),d=(0,bt.default)(l).add(2,"minutes").format("HH:mm:ss");t.emit("relogio",{atual:m,atualizda:d}),t.emit("number::aposta",o);let u=e.split(",").map(f=>Number(f)),_=yield i.bet.findMany({where:{awarded:!1,number_game_result:o,status:"IN_PROCESSING"}});b(0);function b(f){return n(this,null,function*(){let h;if(f>=u.length){console.log(new Date().toTimeString()),clearTimeout(h),yield T(),console.log(new Date().toTimeString()),setTimeout(()=>{},2e3);try{new Promise(function(p,S){return n(this,null,function*(){let w=yield i.$queryRaw`CALL PROCEDURE_BUSCAS_QUANTIDADE_GANHADORES(${o})`;console.log("NEW PROMISE: ",w),yield i.$disconnect(),p(w)})}).then(()=>{setTimeout(()=>n(this,null,function*(){let p=yield i.award.findFirst({where:{gamer_ref:Number(o)},orderBy:{created_at:"desc"}}),S=Number(p==null?void 0:p.subtract_premiums),w=(S>0?S:50).toFixed(2),ot=Number(p==null?void 0:p.subtract_premiums)!=0?Number(p==null?void 0:p.subtract_premiums):50;try{let R=yield i.award.create({data:{total_prizes:w,subtract_premiums:w,seine:Number(w)*75/100,corner:Number(w)*15/100,block:Number(w)*10/100,gamer_ref:(p==null?void 0:p.gamer_ref)+1,is_completed:"IN_PROCESSING",home_deposit:ot}});console.log("INSERT: ",R);let g=yield et.buscarValoresDosPremios();t.emit("/BUSCAR_VALORES_APOSTA",{subtract_premiums:g==null?void 0:g.subtract_premiums,seine:g==null?void 0:g.seine,corner:g==null?void 0:g.corner,block:g==null?void 0:g.block})}catch(R){console.log(R)}console.log("CALCULO REALIZADO!")}),1e4)})}catch(p){console.log(p)}return}h=setTimeout(()=>n(this,null,function*(){t.emit("gamer:total",u[f]),b(f+1)}),1e4),yield Xt._HANDLE(_,u[f]);let A=yield i.bet.findMany({where:{number_game_result:String(o),AND:{}},take:15,orderBy:{hits_round:"desc"},include:{establishment:{select:{name:!0}}}});if(A.length>0){console.log("Entrar");let p=A.map(S=>({id:S.id,namber_bet:S.namber_bet,name:S.establishment.name,namber_round:S.namber_round?S.namber_round.split(","):[]}));setTimeout(()=>t.emit("_GANHADORES_",{_GANHADORES_:p,info:!1}),1e3),console.log("Sair")}})}c(b,"processArray");function T(){return n(this,null,function*(){_.map(h=>{let A=h.numbers.split(",").map(S=>parseInt(S)),p=A.filter(S=>u.includes(S));return At(gt({},h),{hits:p.length,awarded:p.length>=4,numbersArray:A,intersection:p})}).forEach((h,A)=>n(this,null,function*(){yield i.bet.update({where:{id:h.id},data:{hits:h.hits,awarded:!!h.awarded,status:"FINISHED"}})})),setTimeout(()=>i.bet.findMany({where:{number_game_result:{equals:String(o)},AND:{awarded:{equals:!0}}},take:15,orderBy:{hits:"desc"},include:{establishment:{select:{name:!0}}}}).then(h=>{if(h.length>0){let A=h.map(p=>({id:p.id,namber_bet:p.namber_bet,name:p.establishment.name,namber_round:p.namber_round?p.namber_round.split(","):[]}));console.log("setTimeout init",new Date().toTimeString()),t.emit("_GANHADORES_",{_GANHADORES_:A,info:!0}),console.log("setTimeout fim",new Date().toTimeString())}}),2e3)})}c(T,"calculaApostas")}))})}static FN_GET_NUMBER_GAME(){return n(this,null,function*(){return(yield qt()).toString().slice(",")})}static FN_VERIFY_LAST_INSERT_TABLE_GAMER(){return n(this,null,function*(){return yield Vt()})}},c(rt,"CronJobGamer"),rt);var st,Yt=(st=class{static starting(){return n(this,null,function*(){try{let t=yield i.award.findFirst({orderBy:{created_at:"desc"}}),e=t;if(console.log(e),t==null){let r=yield i.award.create({data:{total_prizes:50,subtract_premiums:50,seine:37.5,corner:7.5,block:5,gamer_ref:1,home_deposit:50}})}else if((t==null?void 0:t.is_completed)!="IN_PROCESSING"){let s=yield i.award.create({data:{total_prizes:e==null?void 0:e.subtract_premiums,subtract_premiums:e==null?void 0:e.subtract_premiums,seine:Number(e==null?void 0:e.subtract_premiums)*75/100,corner:Number(e==null?void 0:e.subtract_premiums)*15/100,block:Number(e==null?void 0:e.subtract_premiums)*10/100,gamer_ref:(e==null?void 0:e.gamer_ref)+2,is_completed:"IN_PROCESSING"}})}}catch(t){console.log(t)}})}},c(st,"StartTableAward"),st);var at,Kt=(at=class{static getId(){return n(this,null,function*(){return yield i.game.findFirst({select:{match_id:!0},orderBy:{match_id:"desc"},take:1})})}},c(at,"BuscarUltimoIdoResultado"),at);var D=(0,ut.default)(),ee=Wt.default.createServer(D);D.use((0,Qt.default)());D.use("/static",ut.default.static(Zt.default.join(__dirname,"static")));Yt.starting().catch(a=>console.log(a));var ht=new te.Server(ee,{cors:{origin:"*"}});ht.on("connection",a=>{a.emit("__CLEAN__"),a.join(a.id),a.on("/BUSCAR_DADOS_HORA",t=>n(exports,null,function*(){let e=yield mt.searchForTheLastGame();a.emit("/BUSCAR_DADOS_HORA",e)})),a.on("/BUSCAR_ULTIMO_ID_GAMER",()=>n(exports,null,function*(){let t=yield Kt.getId();a.emit("/BUSCAR_ULTIMO_ID_GAMER",t)})),a.on("/BUSCAR_VALORES_APOSTA",()=>n(exports,null,function*(){console.log("BUSCAR_VALORES_APOSTA");let t=yield et.buscarValoresDosPremios();a.emit("/BUSCAR_VALORES_APOSTA",t)}))});D.use(ut.default.json());D.use((a,t,e)=>{a.io=ht,t.header("Access-Control-Allow-Origin","*"),t.header("Access-Control-Allow-Methods","OPTIONS, GET, PUT, POST, DELETE, HEAD, PATH"),t.header("Access-Control-Allow-Headers","*"),e()});D.use(E);et.buscarValoresDosPremios().then(a=>{});zt.startGamer(ht);ee.listen(process.env.PORT||4008,"0.0.0.0",()=>{console.log(`server running... \u{1F431}\u200D\u{1F3CD} https://apitvgerenciamentomegasena.coringagames.com  port:${process.env.PORT}`)});
