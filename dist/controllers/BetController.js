"use strict";var R=Object.create;var _=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty;var i=(r,e)=>_(r,"name",{value:e,configurable:!0});var L=(r,e)=>{for(var a in e)_(r,a,{get:e[a],enumerable:!0})},h=(r,e,a,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of U(e))!T.call(r,s)&&s!==a&&_(r,s,{get:()=>e[s],enumerable:!(t=y(e,s))||t.enumerable});return r};var M=(r,e,a)=>(a=r!=null?R(g(r)):{},h(e||!r||!r.__esModule?_(a,"default",{value:r,enumerable:!0}):a,r)),w=r=>h(_({},"__esModule",{value:!0}),r);var b=(r,e,a)=>new Promise((t,s)=>{var n=o=>{try{m(a.next(o))}catch(u){s(u)}},c=o=>{try{m(a.throw(o))}catch(u){s(u)}},m=o=>o.done?t(o.value):Promise.resolve(o.value).then(n,c);m((a=a.apply(r,e)).next())});var I={};L(I,{BetController:()=>B});module.exports=w(I);var S=M(require("moment"));var C=require("@prisma/client"),d=new C.PrismaClient;d.$disconnect();function p(){let r=[];for(let t=1;t<=60;t++)r.push(t);for(let t=r.length-1;t>0;t--){let s=Math.floor(Math.random()*(t+1));[r[t],r[s]]=[r[s],r[t]]}return r.slice(0,35).sort((t,s)=>t-s)}i(p,"generateUniqueNumbers12");var O="OPERA\xC7\xC3O EXECUTADA COM SUCESSO.".trim(),N="OPS! OCORREU ALGUM ERRO NO SISTEMA.".trim();var E,f=(E=class{static create(e,a){return b(this,null,function*(){try{let t=yield d.game.findFirst({orderBy:{created_at:"desc"}}),s=t!=null&&t.match_id?(t==null?void 0:t.match_id)+1:1,n=yield d.bet.findFirst({orderBy:{created_at:"desc"}}),c=n!=null&&n.namber_bet?(n==null?void 0:n.namber_bet)+1:1,m=String(e||p()),o=yield this._FN_LOCAL_CREATE_BET(s,m,a,c);return{status:!1,message:O,data:o}}catch(t){return{status:!0,message:t,data:[]}}})}static searchForTheLastGame(){return b(this,null,function*(){var n,c;let e=yield d.$queryRaw`CALL PROCEDURE_GAMES('um')`;console.log("VIEW_BUSCAR_ULTIMO_REGISTRO_TABLE_GAMES: ",e);let a=(c=(n=e[0])==null?void 0:n.created_at)!=null?c:new Date,t=(0,S.default)(a).format("HH:mm:ss"),s=(0,S.default)(a).add(2,"minutes").format("HH:mm:ss");return{hora_database:t,horaAtualida:s}})}static _FN_LOCAL_CREATE_BET(e,a,t,s){return b(this,null,function*(){try{return yield d.bet.create({data:{number_game_result:String(e),numbers:String(a),establishmentId:t},include:{establishment:{select:{name:!0}}}})}catch(n){return n}})}},i(E,"JogosDatabase"),E);var l,B=(l=class{static create(e,a){return b(this,null,function*(){var t;try{let{numbers:s,quantidade:n}=e.body,c=e.user.Establishment[0].id,m=parseInt(n!=null?n:1),o=[];for(let u=0;u<m;u++){let A=yield f.create(s,c);o.push(A)}a.json({content:o})}catch(s){a.json(((t=s==null?void 0:s.meta)==null?void 0:t.target)=="bets_namber_bet_key"?"Tente novamente!":s)}})}},i(l,"BetController"),l);0&&(module.exports={BetController});
