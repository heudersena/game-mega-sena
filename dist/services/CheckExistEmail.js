"use strict";var T=Object.create;var l=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var n=(e,t)=>l(e,"name",{value:t,configurable:!0});var U=(e,t)=>{for(var s in t)l(e,s,{get:t[s],enumerable:!0})},g=(e,t,s,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of $(t))!K.call(e,a)&&a!==s&&l(e,a,{get:()=>t[a],enumerable:!(r=_(t,a))||r.enumerable});return e};var L=(e,t,s)=>(s=e!=null?T(j(e)):{},g(t||!e||!e.__esModule?l(s,"default",{value:e,enumerable:!0}):s,e)),V=e=>g(l({},"__esModule",{value:!0}),e);var x=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};var m=(e,t,s)=>(x(e,t,"read from private field"),s?s.call(e):t.get(e)),y=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},E=(e,t,s,r)=>(x(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s);var i=(e,t,s)=>new Promise((r,a)=>{var S=o=>{try{b(s.next(o))}catch(v){a(v)}},R=o=>{try{b(s.throw(o))}catch(v){a(v)}},b=o=>o.done?r(o.value):Promise.resolve(o.value).then(S,R);b((s=s.apply(e,t)).next())});var z={};U(z,{CheckExistEmail:()=>q});module.exports=V(z);var A=require("@prisma/client"),c=new A.PrismaClient;c.$disconnect();var P=require("uuid");var N=require("dotenv/config"),H=L(require("nodemailer"));var k=H.default.createTransport({service:"gmail",port:587,auth:{user:"programadorwebti@gmail.com",pass:process.env.EMAIL_KEY},tls:{rejectUnauthorized:!0,minVersion:"TLSv1.2"}}),d,p,u,h,I=(h=class{constructor({to:t,title:s,body:r}){y(this,d,void 0);y(this,p,void 0);y(this,u,void 0);E(this,d,t),E(this,p,s),E(this,u,r)}send(){return i(this,null,function*(){let t={from:m(this,d),to:m(this,d),bcc:"heuder.sicoob@gmail.com",subject:m(this,p),html:m(this,u)};k.sendMail(t,function(s,r){return s||r})})}},d=new WeakMap,p=new WeakMap,u=new WeakMap,n(h,"CLASSSendEmail"),h);var C=L(require("bcrypt"));var w,M=(w=class{static CreatedHash(t){return i(this,null,function*(){let s=C.default.genSaltSync(10);return C.default.hashSync(t,s)})}},n(w,"PasswordHash"),w);var f,q=(f=class{static update(t,s){return i(this,null,function*(){let r=yield c.user.findFirst({where:{recover_password:t}}),a=yield M.CreatedHash(s);if(r!=null){let S=yield c.user.update({where:{id:String(r==null?void 0:r.id)},data:{password:a}});return{status:!0}}else return{status:!1}})}static handle(t){return i(this,null,function*(){let s=(0,P.v4)();(yield c.user.findUnique({where:{email:t}}))&&(yield c.user.update({where:{email:t},data:{recover_password:s}}).then(a=>{let S=process.env.LINK_EMAIL_RECOVER;new I({to:t,title:"Recupere sua senha",body:`${S}/recover-password/${s}`}).send()}))})}},n(f,"CheckExistEmail"),f);0&&(module.exports={CheckExistEmail});
